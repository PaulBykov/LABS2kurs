-- Создание временной таблицы для хранения исходных данных
CREATE TABLE #ИсходныеКурсы (
    Идентификатор INT,
    Номер_группы INT,
    Код_преподавателя INT,
    Предмет NVARCHAR(20),
    Тип_занятия NVARCHAR(20)
);

-- Заполнение временной таблицы исходными данными
INSERT INTO #ИсходныеКурсы
SELECT Идентификатор, Номер_группы, Код_преподавателя, Предмет, Тип_занятия
FROM Курсы;

-- Вывод исходных данных
SELECT 'Исходные данные' AS Этап, * FROM #ИсходныеКурсы;

-- Шаг 1: Создание курсора для таблицы Курсы
DECLARE @Код_преподавателя INT = 3; -- Параметр для фильтрации курсов по коду преподавателя

DECLARE КурсорУдаления CURSOR FOR
SELECT Идентификатор, Номер_группы, Код_преподавателя, Предмет, Тип_занятия
FROM Курсы
WHERE Код_преподавателя = @Код_преподавателя;

-- Шаг 2: Открытие курсора
OPEN КурсорУдаления;

-- Шаг 3: Объявление переменных для хранения значений из курсора
DECLARE @Идентификатор INT;
DECLARE @Номер_группы INT;
DECLARE @Код_преподавателя2 INT;
DECLARE @Предмет NVARCHAR(20);
DECLARE @Тип_занятия NVARCHAR(20);

-- Шаг 4: Чтение значений из курсора
FETCH NEXT FROM КурсорУдаления INTO @Идентификатор, @Номер_группы, @Код_преподавателя2, @Предмет, @Тип_занятия;

-- Шаг 5: Цикл по записям курсора
WHILE @@FETCH_STATUS = 0
BEGIN
    -- Пример использования CURRENT OF в операторе DELETE
    DELETE FROM Курсы
    WHERE CURRENT OF КурсорУдаления;

    -- Чтение следующей записи из курсора
    FETCH NEXT FROM КурсорУдаления INTO @Идентификатор, @Номер_группы, @Код_преподавателя2, @Предмет, @Тип_занятия;
END;

-- Шаг 6: Закрытие курсора
CLOSE КурсорУдаления;

-- Шаг 7: Удаление курсора
DEALLOCATE КурсорУдаления;

-- Вывод данных после изменений
SELECT 'Данные после изменений' AS Этап, * FROM Курсы;

-- Удаление временной таблицы
DROP TABLE #ИсходныеКурсы;
